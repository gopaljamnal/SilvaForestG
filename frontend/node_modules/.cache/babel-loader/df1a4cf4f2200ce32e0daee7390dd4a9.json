{"ast":null,"code":"var _jsxFileName = \"/home/gopal/PycharmProjects/Weetwood_react/frontend/src/IciclePlot.js\";\n// src/components/IciclePlot.js\nimport React, { useEffect, useRef, useState } from 'react';\nimport * as d3 from 'd3';\n\n// Helper hook to get the size of the container\nconst useResizeObserver = ref => {\n  const [size, setSize] = useState({\n    width: 0,\n    height: 0\n  });\n  useEffect(() => {\n    const handleResize = () => {\n      if (ref.current) {\n        const {\n          width,\n          height\n        } = ref.current.getBoundingClientRect();\n        setSize({\n          width,\n          height\n        });\n      }\n    };\n    handleResize(); // Initial call\n\n    window.addEventListener('resize', handleResize);\n    return () => window.removeEventListener('resize', handleResize);\n  }, [ref]);\n  return size;\n};\nconst IciclePlot = ({\n  data,\n  decisionRoute,\n  targetDecode\n}) => {\n  const ref = useRef();\n  const {\n    width,\n    height\n  } = useResizeObserver(ref);\n  useEffect(() => {\n    if (!data) {\n      console.error('No data provided to IciclePlot');\n      return;\n    }\n    if (!width || !height) return; // Don't render until dimensions are available\n\n    const color = d3.scaleOrdinal(d3.schemeCategory10);\n    const partition = data => {\n      const root = d3.hierarchy(data).sum(d => d.size).sort((a, b) => b.size - a.size);\n      return d3.partition().size([width, height])(root);\n    };\n    const root = partition(data);\n    const svg = d3.select(ref.current).attr('width', width).attr('height', height);\n    svg.selectAll(\"*\").remove(); // Clear previous contents if any\n\n    const tooltip = d3.select(\"body\").append(\"div\").attr(\"class\", \"tooltip\").style(\"position\", \"absolute\").style(\"visibility\", \"hidden\").style(\"background-color\", \"white\").style(\"border\", \"1px solid #ccc\").style(\"padding\", \"5px\").style(\"border-radius\", \"3px\").style(\"box-shadow\", \"0 0 10px rgba(0,0,0,0.5)\");\n    svg.selectAll(\"rect\").data(root.descendants()).enter().append(\"rect\").attr(\"class\", \"node\").attr(\"x\", d => d.x0).attr(\"y\", d => d.y0).attr(\"width\", d => d.x1 - d.x0).attr(\"height\", d => d.y1 - d.y0).attr(\"fill\", d => color((d.children ? d : d.parent).data.feature)).style(\"stroke\", \"#fff\").on(\"mouseover\", function (event, d) {\n      tooltip.style(\"visibility\", \"visible\").text(`${d.data.feature}`);\n      // .text(`${d.data.feature}: ${d.data.size}`);\n      highlightDecisionRoute(decisionRoute.node_index);\n    }).on(\"mousemove\", function (event) {\n      tooltip.style(\"top\", event.pageY - 10 + \"px\").style(\"left\", event.pageX + 10 + \"px\");\n    }).on(\"mouseout\", function () {\n      tooltip.style(\"visibility\", \"hidden\");\n      svg.selectAll('rect').style('opacity', 1);\n    });\n    svg.selectAll(\"text\").data(root.descendants()).enter().append(\"text\").attr(\"class\", \"label\").attr(\"x\", d => d.x0 + 4).attr(\"y\", d => (d.y0 + d.y1) / 2).text(d => d.data.feature).style(\"fill\", \"#fff\").style(\"font\", \"10px sans-serif\").style(\"text-anchor\", \"start\").style(\"dominant-baseline\", \"middle\");\n    svg.append('text').attr('x', 20).attr('y', 20).text(`Target: ${targetDecode}`).style('font', '14px sans-serif').style('fill', '#000');\n    const highlightDecisionRoute = nodeIndex => {\n      const routeNodes = root.descendants().filter(d => Object.values(nodeIndex).includes(d.data.featureid));\n      svg.selectAll('rect').style('opacity', 0.3);\n      routeNodes.forEach(d => {\n        svg.selectAll('rect').filter(node => node.data === d.data).style('opacity', 1);\n      });\n    };\n  }, [data, width, height, decisionRoute, targetDecode]);\n  return /*#__PURE__*/React.createElement(\"svg\", {\n    ref: ref,\n    style: {\n      width: '100%',\n      height: '100%'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 122,\n      columnNumber: 5\n    }\n  });\n};\nexport default IciclePlot;","map":{"version":3,"names":["React","useEffect","useRef","useState","d3","useResizeObserver","ref","size","setSize","width","height","handleResize","current","getBoundingClientRect","window","addEventListener","removeEventListener","IciclePlot","data","decisionRoute","targetDecode","console","error","color","scaleOrdinal","schemeCategory10","partition","root","hierarchy","sum","d","sort","a","b","svg","select","attr","selectAll","remove","tooltip","append","style","descendants","enter","x0","y0","x1","y1","children","parent","feature","on","event","text","highlightDecisionRoute","node_index","pageY","pageX","nodeIndex","routeNodes","filter","Object","values","includes","featureid","forEach","node","createElement","__self","__source","fileName","_jsxFileName","lineNumber","columnNumber"],"sources":["/home/gopal/PycharmProjects/Weetwood_react/frontend/src/IciclePlot.js"],"sourcesContent":["// src/components/IciclePlot.js\nimport React, { useEffect, useRef, useState } from 'react';\nimport * as d3 from 'd3';\n\n// Helper hook to get the size of the container\nconst useResizeObserver = (ref) => {\n  const [size, setSize] = useState({ width: 0, height: 0 });\n\n  useEffect(() => {\n    const handleResize = () => {\n      if (ref.current) {\n        const { width, height } = ref.current.getBoundingClientRect();\n        setSize({ width, height });\n      }\n    };\n\n    handleResize(); // Initial call\n\n    window.addEventListener('resize', handleResize);\n    return () => window.removeEventListener('resize', handleResize);\n  }, [ref]);\n\n  return size;\n};\n\nconst IciclePlot = ({ data, decisionRoute, targetDecode }) => {\n  const ref = useRef();\n  const { width, height } = useResizeObserver(ref);\n\n  useEffect(() => {\n    if (!data) {\n      console.error('No data provided to IciclePlot');\n      return;\n    }\n\n    if (!width || !height) return; // Don't render until dimensions are available\n\n    const color = d3.scaleOrdinal(d3.schemeCategory10);\n\n    const partition = (data) => {\n      const root = d3.hierarchy(data)\n        .sum((d) => d.size)\n        .sort((a, b) => b.size - a.size);\n      return d3.partition()\n        .size([width, height])(root);\n    };\n\n    const root = partition(data);\n\n    const svg = d3.select(ref.current)\n      .attr('width', width)\n      .attr('height', height);\n\n    svg.selectAll(\"*\").remove(); // Clear previous contents if any\n\n    const tooltip = d3.select(\"body\").append(\"div\")\n      .attr(\"class\", \"tooltip\")\n      .style(\"position\", \"absolute\")\n      .style(\"visibility\", \"hidden\")\n      .style(\"background-color\", \"white\")\n      .style(\"border\", \"1px solid #ccc\")\n      .style(\"padding\", \"5px\")\n      .style(\"border-radius\", \"3px\")\n      .style(\"box-shadow\", \"0 0 10px rgba(0,0,0,0.5)\");\n\n    svg.selectAll(\"rect\")\n      .data(root.descendants())\n      .enter().append(\"rect\")\n      .attr(\"class\", \"node\")\n      .attr(\"x\", (d) => d.x0)\n      .attr(\"y\", (d) => d.y0)\n      .attr(\"width\", (d) => d.x1 - d.x0)\n      .attr(\"height\", (d) => d.y1 - d.y0)\n      .attr(\"fill\", (d) => color((d.children ? d : d.parent).data.feature))\n      .style(\"stroke\", \"#fff\")\n      .on(\"mouseover\", function (event, d) {\n        tooltip.style(\"visibility\", \"visible\")\n          .text(`${d.data.feature}`);\n        // .text(`${d.data.feature}: ${d.data.size}`);\n        highlightDecisionRoute(decisionRoute.node_index);\n      })\n      .on(\"mousemove\", function (event) {\n        tooltip.style(\"top\", (event.pageY - 10) + \"px\")\n          .style(\"left\", (event.pageX + 10) + \"px\");\n      })\n      .on(\"mouseout\", function () {\n        tooltip.style(\"visibility\", \"hidden\");\n        svg.selectAll('rect').style('opacity', 1);\n      });\n\n    svg.selectAll(\"text\")\n      .data(root.descendants())\n      .enter().append(\"text\")\n      .attr(\"class\", \"label\")\n      .attr(\"x\", (d) => d.x0 + 4)\n      .attr(\"y\", (d) => (d.y0 + d.y1) / 2)\n      .text((d) => d.data.feature)\n      .style(\"fill\", \"#fff\")\n      .style(\"font\", \"10px sans-serif\")\n      .style(\"text-anchor\", \"start\")\n      .style(\"dominant-baseline\", \"middle\");\n\n    svg.append('text')\n      .attr('x', 20)\n      .attr('y', 20)\n      .text(`Target: ${targetDecode}`)\n      .style('font', '14px sans-serif')\n      .style('fill', '#000');\n\n    const highlightDecisionRoute = (nodeIndex) => {\n      const routeNodes = root.descendants().filter(d => Object.values(nodeIndex).includes(d.data.featureid));\n      svg.selectAll('rect').style('opacity', 0.3);\n      routeNodes.forEach(d => {\n        svg.selectAll('rect')\n          .filter(node => node.data === d.data)\n          .style('opacity', 1);\n      });\n    };\n  }, [data, width, height, decisionRoute, targetDecode]);\n\n  return (\n    <svg ref={ref} style={{ width: '100%', height: '100%' }}></svg>\n  );\n};\n\nexport default IciclePlot;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}